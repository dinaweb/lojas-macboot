<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="pt-br" lang="pt-br">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta charset="UTF-8">
		<title>Lojas Macboot</title>
		<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
		<link rel="stylesheet" type="text/css" href="css/font-awesome.min.css">
		<link rel="stylesheet" type="text/css" href="css/main.css">
	</head>
	<body class="bg-lightgray">
		<div class="container bg-white">
			<section class="header">
				<div class="intro-header">
					<div class="intro-content">
						<img src="images/macboot-logo_branco.png" alt="Macboot" class="heading-logo">
						<div class="intro-text">
							<h1>Onde Encontrar?</h1>
						</div>
					</div>
				</div>
			</section>
			<div class="container">
				<h1 class="txtcenter darkgreen">A MACBOOT MAIS PERTO DE VOCÊ</h1>
				<p class="txtcenter hidemobile">Procure um ponto de venda perto de você para adquirir seu Macboot.</p>
				<div class="col-md-8 hidemobile"> 
					<div id="regions_div" style="width: 900px; height: 500px;"></div>
				</div>
				<div class="col-md-4 feature">
					<p>São <b class="darkgreen">130 lojas</b> em todo o Brasil</p>
					<select id="seletorCombo">
						<option>Selecione um Estado</option>
						<option value="1">Acre</option>
						<option value="2">Alagoas</option>
						<option value="3">Amapa</option>
						<option value="4">Amazonas</option>
						<option value="5">Bahia</option>
						<option value="6">Ceara</option>
						<option value="7">Distrito Federal</option>
						<option value="8">Espirito Santo</option>
						<option value="9">Goias</option>
						<option value="10">Maranhão</option>
						<option value="11">Mato Grosso</option>
						<option value="12">Mato Grosso do Sul</option>
						<option value="13">Minas Gerais</option>
						<option value="14">Para</option>
						<option value="15">Paraíba</option>
						<option value="16">Parana</option>
						<option value="17">Pernambuco</option>
						<option value="18">Piaui</option>
						<option value="19">Rio de Janeiro</option>
						<option value="20">Rio Grande do Norte</option>
						<option value="21">Rio Grande do Sul</option>
						<option value="22">Rondonia</option>
						<option value="23">Roraima</option>
						<option value="24">Santa Catarina</option>
						<option value="25">Sao Paulo</option>
						<option value="26">Sergipe</option>
						<option value="27">Tocantins</option>
					</select>
					<select id="cidades"></select>
					<p> Pontos de Venda: <strong class="" id="estado"></strong>
					<div id="dadosLojas" class="stores"> 

					</div>
				</div>
			</div>
			<footer class="bg-darkgreen">
				<p class="txtcenter white">
					<b>MACBOOT indústria e Comércio de Calçados Ltda.</b><br/>
					Avenida Ângelo Pedro, 2854 - Vila Santa Cruz - Franca/SP - CEP: 14403-416
					CNPJ: 68.403.583/0001-35 - Fone: (16) 2104-7400
				</p>
			</footer>
		</div>
		<script type="text/javascript" src="js/loader.js"></script>
		<script type="text/javascript" src="js/jsapi.js"></script>
		<script type="text/javascript" src="js/jquery-3.3.1.min.js"></script>
		<script type="text/javascript">
			google.charts.load('current', {'packages':['geochart']});
			google.charts.setOnLoadCallback(drawRegionsMap);

			dicEstados = {
					'1' : 'Acre',
					'2' : 'Alagoas',
					'3' : 'Amapá',
					'4' : 'Amazonas',
					'5' : 'Bahia',
					'6' : 'Ceará',
					'7' : 'Distrito Federal',
					'8' : 'Espírito Santo',
					'9' : 'Goiás',
					'10' : 'Maranhão',
					'11' : 'Mato Grosso',
					'12' : 'Mato Grosso do Sul',
					'13' : 'Minas Gerais',
					'14' : 'Pará',
					'15' : 'Paraíba',
					'16' : 'Paraná',
					'17' : 'Pernambuco',
					'18' : 'Piauí',
					'19' : 'Rio de Janeiro',
					'20' : 'Rio Grande do Norte',
					'21' : 'Rio Grande do Sul',
					'22' : 'Rondônia',
					'23' : 'Roraima',
					'24' : 'Santa Catarina',
					'25' : 'São Paulo',
					'26' : 'Sergipe',
					'27' : 'Tocantins'
			}
			
			//o array abaixo pode ser alimentado por uma base de dados, ou api rest. no exemplo, deixei fixo.
			unidades = {
				'São Paulo': {
					'Americana' : {
						'0' : {
							'Loja' : 'AMERICANA COMERCIO DE EPIS EIR',
							'Fone' : '(19) 3604-8992',
							'Endereco' : 'R EDUARDO MEDON,628 - STA SOFIA'
						},
						'1' : {
							'Loja' : 'CALCADISTA LOJA 02',
							'Fone' : '(19) 9188-0474',
							'Endereco' : 'R TRINTA DE JULHO, 114 - CENTRO'
						}, 
						'2' : {
							'Loja' : 'IRMAOS BACHEGA LTDA',
							'Fone' : '(19) 3461-7500',
							'Endereco' : 'R TRINTA DE JULHO 210 - CENTRO'
						}
					},
					'Ribeirão Preto' : { 
						'0' : {
							'Loja' : 'DI GASPI 15 BM VI 647',
							'Fone' : '(16) 3617-1306',
							'Endereco' : 'AV PRESIDENTE KENNEDY 1500 ARCOS 176/178 - RIBEIRANIA'
						}, 
						'1' : {
							'Loja' : 'HUMANITARIAN LJ 4',
							'Fone' : '(16) 4042-1922',
							'Endereco' : 'RUA VISCONDE DE INHAUMA 451 - CENTRO'
						}
					}
				}
			}

			var ultimoEstadoSelecionado = '';


			function drawRegionsMap() {

				var data = google.visualization.arrayToDataTable([
					['Country'],
					['Brazil'],
					['Acre'],
					['Alagoas'],
					['Amapá'],
					['Amazonas'],
					['Bahia'],
					['Ceará'],
					['Distrito Federal'],
					['Espírito Santo'],
					['Goiás'],
					['Maranhão'],
					['Mato Grosso'],
					['Mato Grosso do Sul'],
					['Minas Gerais'],
					['Pará'],
					['Paraiba'],
					['Paraná'],
					['Pernambuco'],
					['Piauí'],
					['Rio de Janeiro'],
					['Rio Grande do Norte'],
					['Rio Grande do Sul'],
					['Rondônia'],
					['Roraima'],
					['Santa Catarina'],
					['São Paulo'],
					['Sergipe'],
					['Tocantins']
				]);

				var options = {
					 region: 'BR',
					 resolution: 'provinces',
					 datalessRegionColor: 'white',
					 defaultColor: '#BCC829',
					 enableRegionInteractivity: true
				};

				var chart = new google.visualization.GeoChart(document.getElementById('regions_div'));
				
				function myClickHandler(){
					var selection = chart.getSelection();
					var message = '';
					for (var i = 0; i < selection.length; i++) {
							var item = selection[i];
							if (item.row != null && item.column != null) {
									message += '{' + item.row + ',column:' + item.column + '}';
							} else if (item.row != null) {
									message += '' + item.row + '';
							} else if (item.column != null) {
									message += '{column:' + item.column + '}';
							}
					}
					if (message == '') {
							message = ultimoEstadoSelecionado;
					}else{
							ultimoEstadoSelecionado = message;
					}

					document.getElementById("seletorCombo").selectedIndex = message;
					document.getElementById("cidades").innerHTML = '';
					document.getElementById("dadosLojas").innerHTML = '';
					var cities = Object.entries(unidades[dicEstados[message]]);
					document.getElementById("cidades").innerHTML = '<option value="">Selecione uma cidade</option>';
					for(let city of cities) { 
						document.getElementById("cidades").innerHTML +=
						'<option value="' + city[0] + '">' + city[0] + '</option>'
					}
					$('#cidades').change(function() {
						valCidade = $(this).val();
						document.getElementById("dadosLojas").innerHTML = '';
						for(var i = 0; i < Object.keys(unidades[dicEstados[message]][valCidade]).length;  i ++){ 
							document.getElementById("estado").innerHTML = valCidade + ' ' + dicEstados[message];
							document.getElementById("dadosLojas").innerHTML += 
							'<b>' + unidades[dicEstados[message]][valCidade][i]['Loja'] + 
							'</b><br>' + unidades[dicEstados[message]][valCidade][i]['Endereco'] + 
							'<br>Fone: ' + unidades[dicEstados[message]][valCidade][i]['Fone'] + 
							'<br><a href="https://maps.google.com/?q=' + unidades[dicEstados[message]][valCidade][i]['Endereco'] + '" rel="noreferrer" target="_blank">veja no Google Maps</a><br/><hr>';
						}
					})
				}
				google.visualization.events.addListener(chart, 'select', myClickHandler);
				chart.draw(data, options);

					$('#seletorCombo').change(function(){
						valEstado = $(this).val();
						arraySelection = [];
						arraySelection.push({column:null,row:Number(valEstado)});


						function myComboHandler(option){
							var selection = option;
							console.log(selection);
							var message = '';
							for (var i = 0; i < selection.length; i++) {
								var item = selection[i];
								if (item.row != null && item.column != null) {
									message += '{' + item.row + ',column:' + item.column + '}';
								} else if (item.row != null) {
									message += '' + item.row + '';
								} else if (item.column != null) {
									message += '{column:' + item.column + '}';
								}
							}
							if (message == '') {
								message = 'nothing';
								return false;
							}
							document.getElementById("cidades").innerHTML = '';
							document.getElementById("dadosLojas").innerHTML = '';
							var cities = Object.entries(unidades[dicEstados[message]]);
							document.getElementById("cidades").innerHTML = '<option value="">Selecione uma cidade</option>';
							for(let city of cities) { 
								document.getElementById("cidades").innerHTML +=
								'<option value="' + city[0] + '">' + city[0] + '</option>'
							}
							$('#cidades').change(function() {
								valCidade = $(this).val();
								document.getElementById("dadosLojas").innerHTML = '';
								for(var i = 0; i < Object.keys(unidades[dicEstados[message]][valCidade]).length;  i ++){ 
									document.getElementById("estado").innerHTML = valCidade + ' ' + dicEstados[message];
									document.getElementById("dadosLojas").innerHTML += 
									'<b>' + unidades[dicEstados[message]][valCidade][i]['Loja'] + 
									'</b><br>' + unidades[dicEstados[message]][valCidade][i]['Endereco'] + 
									'<br>Fone: ' + unidades[dicEstados[message]][valCidade][i]['Fone'] + 
									'<br><a href="https://maps.google.com/?q=' + unidades[dicEstados[message]][valCidade][i]['Endereco'] + '" rel="noreferrer" target="_blank">veja no Google Maps</a><br/><hr>';
								}
							})
						}
						

						google.visualization.events.addListener(chart, 'select', myComboHandler);

							chart.draw(data, options);

							myComboHandler(arraySelection);
				});
			}
		</script>
	</body>
</html>

		
